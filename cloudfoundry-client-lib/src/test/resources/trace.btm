RULE 1- throw IOException socket opening
CLASS ^java.net.Socket
METHOD <init> (String , int , InetAddress,  int)
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO throwExceptionIfForbidden($1, $2)
ENDRULE

RULE 2- throw IOException socket opening
CLASS ^java.net.Socket
METHOD <init> (SocketAddress , SocketAddress, boolean )
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO throwExceptionIfForbidden($1)
ENDRULE

# Does not seem to trigger
RULE 2c- throw IOException socket opening
CLASS ^java.net.Socket
METHOD checkAddress (InetAddress addr, String op)
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO alwaysThrowException()"), //throwExceptionIfForbidden($1)
ENDRULE

RULE 2c- throw IOException socket opening: throws IOException if a socket is unexpectedly directly openened without going through http proxy
CLASS ^java.net.Socket
METHOD connect(SocketAddress)
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO throwExceptionIfForbidden($1)
ENDRULE

# Broken because of byteman bug https://issues.jboss.org/browse/BYTEMAN-216
# RULE 2c- throw IOException socket opening
# CLASS ^java.net.Socket
# METHOD connect(SocketAddress, int )
# HELPER org.cloudfoundry.client.lib.SocketDestHelper
# IF TRUE
# DO alwaysThrowException()"), //throwExceptionIfForbidden($1)
# ENDRULE

RULE 3- throw IOException SSL socket opening
CLASS ^java.net.ssl.SSLSocket
METHOD <init> (InetAddress , int )
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO throwExceptionIfForbidden($1)
ENDRULE

RULE 4- throw IOException SSL socket opening
CLASS ^java.net.ssl.SSLSocket
METHOD <init> (InetAddress, int , InetAddress , int )
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO throwExceptionIfForbidden($1, $2)
ENDRULE

RULE 5- throw IOException SSL socket opening
CLASS ^java.net.ssl.SSLSocket
METHOD <init> (String, int )
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO throwExceptionIfForbidden($1, $2)
ENDRULE

RULE 6- throw IOException SSL socket opening
CLASS ^java.net.ssl.SSLSocket
METHOD <init> (String, int ,InetAddress , int )
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO throwExceptionIfForbidden($1, $2)
ENDRULE

RULE 7- throw IOException SSL socket opening
CLASS ^java.net.ssl.SSLSocketFactory
METHOD getDefault()
HELPER org.cloudfoundry.client.lib.SocketDestHelper
IF TRUE
DO getDefaultSslSocketFactory()
ENDRULE

